function readyOptIn(e){(document.attachEvent?document.readyState==="complete":document.readyState!=="loading")?e():document.addEventListener("DOMContentLoaded",e)}var baseUrl="https://www.newyorker.de",assetsUrl="https://api.newyorker.de/public/lib/opt-in-tracking/v1.1.2/assets",googleAnalyticsId="UA-25949291-1",defaultLang="de",optInI18n={translations:{},initTranslations:function(e,t){var n=this;this.loadTranslations(e,function(e){if(e){t(e);return}n.loadTranslations("en",t)})},loadTranslations:function(e,t){var n=new XMLHttpRequest,r=this;n.onreadystatechange=function(){if(n.readyState===4)if(n.status===200)try{r.translations=JSON.parse(n.responseText),t(r.translations)}catch(e){console.log("error while loading translations: ",e),t(null)}else console.log("error while loading translations: ",e),t(null)},n.open("GET",assetsUrl+"/i18n/"+e+".json"),n.send()},initLocale:function(){var e=window.location.href,t=defaultLang;if(e.toLocaleLowerCase().indexOf("jobs.newyorker.de")!==-1){var n=this.getParameterByName("L",e);return n&&n==="2"?{country:"en",language:"en"}:{country:"de",language:"de"}}var r=e.substr(e.indexOf("newyorker.de/")+13).split("/");if(r&&r.length>0){t=r[0];if(!t||t===""||t.startsWith("host")||t.length>2)t=defaultLang}var i=t;switch(t){case"at":t="de";break;case"ch":t="de";break;case"dk":t="da";break;case"ba":t="bs";break;case"cz":t="cs";break;case"ee":t="et";break;case"lu":t="fr",i="fr";break;case"rs":t="sr";break;case"se":t="sv";break;case"qa":t="ar";break;case"ma":t="ar";break;case"me":t="me-me";break;case"sa":t="ar";break;case"ae":t="ar";break;case"am":t="hy";break;case"ge":t="ka";break;case"kz":t="kk"}return{country:i,language:t}},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},msg:function(e){var t=this.translations[e];return t?t:e}},COOKIE_KEY="NY_USER_GAVE_TRACKING_PERMISSION",NY_TRACKER=NY_TRACKER||{GA_TRACKING_ID:googleAnalyticsId,initialized:!1,activateTracking:function(){var e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id="+this.GA_TRACKING_ID,document.querySelector("body").appendChild(e),window.dataLayer=window.dataLayer||[],this._gtag("js",new Date),this._gtag("config",this.GA_TRACKING_ID,{anonymize_ip:!0}),localStorage.setItem(COOKIE_KEY,"true"),this._hideOptInBanner(),this.initialized=!0},deactivateTracking:function(){localStorage.setItem(COOKIE_KEY,"false"),this._hideOptInBanner(),window["ga-disable-"+this.GA_TRACKING_ID]=!0},trackPage:function(e,t){if(!this.initialized){console.log("ga-service not initialized");return}this._gtag("config",this.GA_TRACKING_ID,{page_title:t,page_path:e})},trackClick:function(e){if(!this.initialized){console.log("ga-service not initialized");return}this._gtag("event",e.action,{event_category:e.category,event_label:e.label,value:e.value})},_gtag:function(){dataLayer.push(arguments)},_hideOptInBanner:function(){var e=document.querySelector(".cookieBanner");e&&e.classList.add("hide")}};readyOptIn(function(){function n(e,t){var n=document.createElement("div");n.innerHTML=t;while(n.children.length>0)e.appendChild(n.children[0])}var e=localStorage.getItem(COOKIE_KEY);if(e==="true"){NY_TRACKER.activateTracking();return}var t=optInI18n.initLocale();optInI18n.initTranslations(t.language,function(){var e=optInI18n.msg("opt_in_text"),r="";t.language!==defaultLang&&(r="/"+t.country);var i=baseUrl+r+"/legal/privacy/",s=optInI18n.msg("opt_in_link_text"),o=optInI18n.msg("opt_in_button_text"),u=assetsUrl+"/opt-in.css",a='<div class="cookieBanner"><link href="'+u+'" rel="stylesheet" type="text/css">'+'<div class="cookieBannerHolder">'+'<div class="cookieBannerButtons">'+'<button onclick="NY_TRACKER.activateTracking()">'+o+"</button>"+"</div>"+'<div class="cookieBannerText">'+e+'<a class="cookieBannerLink" href="'+i+'" target="_blank">'+s+"</a>"+"</div>"+"</div>"+"</div>";n(document.body,a)})})